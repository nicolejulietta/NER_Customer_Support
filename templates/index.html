<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NER Project</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='styles.css') }}"
    />
  </head>
  <body>
    <div class="container">
      <h1>Named Entity Recognition</h1>
      <form method="POST">
        <textarea
          id="input-text"
          name="text_input"
          placeholder="Paste your text here..."
          rows="10"
          cols="50"
        ></textarea>
        <div id="checkboxes">
          <p><strong>Customer Support</strong></p>
          <label
            ><input type="checkbox" name="entity" value="customer_names" />
            Customer Names</label
          >
          <label
            ><input type="checkbox" name="entity" value="support_agents" />
            Support Agents</label
          >
          <label
            ><input type="checkbox" name="entity" value="order_numbers" /> Order
            Numbers</label
          >
          <label
            ><input type="checkbox" name="entity" value="ticket_numbers" />
            Ticket Numbers</label
          >
          <label
            ><input
              type="checkbox"
              name="entity"
              value="support_ticket_status"
            />
            Support Ticket Status</label
          >
          <label
            ><input type="checkbox" name="entity" value="time_date" />
            Time/Date</label
          >
          <label
            ><input type="checkbox" name="entity" value="complaint_types" />
            Complaint Types</label
          >
          <label
            ><input type="checkbox" name="entity" value="refund_request" />
            Refund Request</label
          >
          <label
            ><input type="checkbox" name="entity" value="shipping_info" />
            Shipping Info</label
          >
          <label
            ><input
              type="checkbox"
              name="entity"
              value="discounts_promotions"
            />
            Discounts/Promotions</label
          >
          <label
            ><input type="checkbox" name="entity" value="customer_feedback" />
            Customer Feedback</label
          >
          <label
            ><input type="checkbox" name="entity" value="service_req_types" />
            Service Req Types</label
          >
          <label
            ><input type="checkbox" name="entity" value="support_channel" />
            Support Channel</label
          >
          <label
            ><input type="checkbox" name="entity" value="escalation_request" />
            Escalation Request</label
          >
          <label
            ><input type="checkbox" name="entity" value="product_models" />
            Product Models</label
          >
          <p><strong>Customer Service</strong></p>
          <label
            ><input type="checkbox" name="entity" value="customer_names" />
            Customer Names</label
          >
          <label
            ><input type="checkbox" name="entity" value="support_reps" />
            Support Reps</label
          >
          <label
            ><input type="checkbox" name="entity" value="order_names" /> Order
            Names</label
          >
          <label
            ><input type="checkbox" name="entity" value="ticket_names" /> Ticket
            Names</label
          >
          <label
            ><input type="checkbox" name="entity" value="customer_queries" />
            Customer Queries</label
          >
          <label
            ><input type="checkbox" name="entity" value="service_types" />
            Service Types</label
          >
          <label
            ><input type="checkbox" name="entity" value="complaint_types" />
            Complaint Types</label
          >
          <label
            ><input type="checkbox" name="entity" value="refund_request" />
            Refund Requests</label
          >
          <label
            ><input type="checkbox" name="entity" value="feedback" />
            Feedback</label
          >
          <label
            ><input type="checkbox" name="entity" value="shipping_info" />
            Shipping Info</label
          >
          <label
            ><input
              type="checkbox"
              name="entity"
              value="cust_satisfaction_rating"
            />
            Cust Satisfaction Rating</label
          >
          <label
            ><input type="checkbox" name="entity" value="payment_issues" />
            Payment Issues</label
          >
          <label
            ><input type="checkbox" name="entity" value="product_names" />
            Product Names</label
          >
          <label
            ><input type="checkbox" name="entity" value="company_names" />
            Company Names</label
          >
          <label
            ><input type="checkbox" name="entity" value="time_date" />
            Time/Date</label
          >
        </div>
        <button type="submit" id="process-btn">Process Text</button>
      </form>
      <div id="output-text">
        {% if processed_text %}
        <p><strong>Processed Text:</strong></p>
        <p id="highlighted-text">{{ processed_text }}</p>
        {% endif %}
      </div>
    </div>
    <script>
      const checkboxElements = document.querySelectorAll(
        'input[type="checkbox"]'
      );
      const highlightedTextElement =
        document.getElementById("highlighted-text");

      const colors = {
        customer_names: "#ffcccb",
        support_agents: "#ccffcc",
        order_numbers: "#ffeb3b",
      };

      function highlightText(entities) {
        let text = highlightedTextElement.innerHTML;

        entities.forEach((entity) => {
          if (document.querySelector(`input[value="${entity}"]`).checked) {
            const regex = new RegExp(`\\b${entity}\\b`, "g");
            const color = colors[entity] || "#ffff00";
            text = text.replace(
              regex,
              `<span class="highlight" style="background-color:${color}">${entity}</span>`
            );
          }
        });

        highlightedTextElement.innerHTML = text;
      }

      checkboxElements.forEach((checkbox) => {
        checkbox.addEventListener("change", function () {
          const entities = Array.from(checkboxElements)
            .filter((checkbox) => checkbox.checked)
            .map((checkbox) => checkbox.value);

          highlightText(entities);
        });
      });
    </script>
  </body>
</html>
